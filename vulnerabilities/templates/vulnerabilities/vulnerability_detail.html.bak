<!-- vulnerabilities/templates/vulnerabilities/vulnerability_detail.html -->
{% extends 'vulnerabilities/base.html' %}

{% block title %}{{ vulnerability.title }} - 漏洞详情{% endblock %}

{% block content %}
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">{{ vulnerability.title }}</h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Key:</strong> {{ vulnerability.key }}</p>
                    <p><strong>描述:</strong> {{ vulnerability.description }}</p>
                    <p><strong>严重性:</strong> 
                        <span class="badge 
                            {% if vulnerability.severity == '高' %}
                                badge-danger
                            {% elif vulnerability.severity == '中' %}
                                badge-warning
                            {% else %}
                                badge-success
                            {% endif %}
                        ">
                            {{ vulnerability.severity }}
                        </span>
                    </p>
                    <p><strong>CVE:</strong> 
                        {% if vulnerability.cve %}
                            <a href="https://www.cve.org/CVERecord?id={{ vulnerability.cve }}" target="_blank">{{ vulnerability.cve }}</a>
                        {% else %}
                            N/A
                        {% endif %}
                    </p>
                    <p><strong>披露时间:</strong> {{ vulnerability.disclosure }}</p>
                    <p><strong>解决方案:</strong> {{ vulnerability.solutions }}</p>
                    <p><strong>推送状态:</strong> {{ vulnerability.pushed|yesno:"已推送,未推送" }}</p>
                    <p><strong>创建时间:</strong> {{ vulnerability.create_time }}</p>
                    <p><strong>更新时间:</strong> {{ vulnerability.update_time }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>参考资料:</strong> 
                        {% if parsed_references %}
                            <ul>
                                {% for ref in parsed_references %}
                                    <li><a href="{{ ref }}" target="_blank">{{ ref }}</a></li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            N/A
                        {% endif %}
                    </p>
                    <p><strong>来源:</strong> 
                        {% if vulnerability.source %}
                            <a href="{{ vulnerability.source }}" target="_blank">{{ vulnerability.source }}</a>
                        {% else %}
                            N/A
                        {% endif %}
                    </p>
                    <p><strong>标签:</strong> 
                        {% if vulnerability.tags %}
                            {% for tag in vulnerability.tags %}
                                <span class="badge badge-secondary">{{ tag }}</span>
                            {% endfor %}
                        {% else %}
                            N/A
                        {% endif %}
                    </p>
                    <p><strong>GitHub 搜索:</strong> 
                        {% if vulnerability.github_search %}
                            {% for gh in vulnerability.github_search %}
                                <a href="{{ gh }}" target="_blank" class="btn btn-outline-primary btn-sm mb-1">{{ gh }}</a>
                            {% endfor %}
                        {% else %}
                            N/A
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
    </div>

    <a href="{% url 'vulnerabilities:vulnerability_list' %}" class="btn btn-secondary">返回列表</a>
{% endblock %}